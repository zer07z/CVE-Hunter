# oscs爬虫实现
import requests
import json
import re

urls = 'https://www.oscs1024.com/oscs/v1/vdb/info'
header = {
    "User-Agent":
    "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36"
}
a = {
    "vuln_no": "CVE-2023-0756"
}  # CVE-2023-29827   CVE-2023-0756   CVE-2023-32007
res = requests.post(url=urls, json=a, headers=header)
json_dict = json.loads(res.text)
print(res.text)
version_list = []
for vuln_dict in json_dict['data'][0]['effect']:
    version_list.append(f'{vuln_dict["name"]}@{vuln_dict["affected_version"]}')
# print(version_list)
repair_list = json_dict['data'][0]['soulution_data']
# print(repair)